---
title: Django 2개의 모델을 비교해 필드값 업데이트하기
comments: true
description: 2개의 모델의 필드값을 비교해서 하나의 모델에 필드값을 업데이트하는 방법에 대한 포스팅입니다.
categories:
 - Django
tags: django, develop, backend
---
## 모델 만들기

### models.py

{% highlight python linenos %}
class Lone(models.Model):
    choice = (
        ('대출완료','대출완료'),
        ('회수중','회수중'),
        ('회수완료','회수완료'),
    )
    user_id	= models.ForeignKey(User)
    attention = models.CharField(max_length=10, choices=choice, default='대출완료')
    price = models.FloatField()

class Payback(models.Model):
    lone_id	= models.ForeignKey(Lone)
    payback = models.FloatField()
{% endhighlight %}

대출과 회수에 대한 모델을 예시로 만들어서 해보도록하겠습니다. 

- 대출 모델에 대한 필드
	- ID (PrimaryKey)
	- 사용자 ID (ForeignKey)
	- 상태 (대출완료, 회수중, 회수완료)
	- 대출금

- 회수 모델에 대한 필드
	- ID (PrimaryKey)
	- 대출모델 ID (ForeignKey)
	- 회수금

> 대출금과 회수금을 비교해서 대출모델의 상태를 업데이트하는 로직을 구현하려고 합니다!!!


### models.py

{% highlight python linenos %}
...
def attention_pre_save(sender, instance, *args, **kwargs):
    qs = Lone.objects.get(pk=Payback.lone_id.id)
    ## 대출금과 회수금이 같을 시 "대출완료"
    if int(qs.price) == int(instance.payback):
        qs.attention = '대출완료'
        qs.save()
    ## 회수금이 0보다 클 시 "대출중"
    elif int(instance.payback) > 0:
        qs.attention = '대출중'
        qs.save()

pre_save.connect(attention_pre_save, sender=Payback)

{% endhighlight %}
